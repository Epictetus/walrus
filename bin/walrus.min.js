/**
 * Walrus.js 0.4.4
 * (c) 2012 Jeremy Ruppel
 * Walrus.js is freely distributable under the terms of the MIT license.
 * https://raw.github.com/jeremyruppel/walrus/master/LICENSE
 */
((function(){var a,b,c,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a},f=Array.prototype.slice;c={VERSION:"0.4.4"};var g=function(){var a={trace:function(){},yy:{},symbols_:{error:2,document:3,text:4,EOF:5,statements:6,statement:7,OPEN:8,helper:9,mustache:10,block:11,CLOSE:12,CONTENT:13,expression:14,PIPE:15,filters:16,ATTR:17,paths:18,DOT:19,primitive:20,OPEN_BLOCK:21,CLOSE_BLOCK:22,HELP:23,MEMBER:24,filter:25,OPEN_PAREN:26,arguments:27,CLOSE_PAREN:28,path:29,method:30,member:31,COMMA:32,argument:33,SINGLE_QUOTE_STRING_LITERAL:34,DOUBLE_QUOTE_STRING_LITERAL:35,BOOLEAN_FALSE:36,BOOLEAN_TRUE:37,NUMBER:38,SAFE:39,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:"OPEN",12:"CLOSE",13:"CONTENT",15:"PIPE",17:"ATTR",19:"DOT",21:"OPEN_BLOCK",22:"CLOSE_BLOCK",23:"HELP",24:"MEMBER",26:"OPEN_PAREN",28:"CLOSE_PAREN",32:"COMMA",34:"SINGLE_QUOTE_STRING_LITERAL",35:"DOUBLE_QUOTE_STRING_LITERAL",36:"BOOLEAN_FALSE",37:"BOOLEAN_TRUE",38:"NUMBER",39:"SAFE"},productions_:[0,[3,2],[4,1],[6,2],[6,1],[7,4],[7,3],[7,1],[10,3],[10,1],[14,2],[14,1],[14,1],[14,1],[11,4],[9,2],[16,2],[16,1],[25,5],[25,2],[18,3],[18,1],[29,1],[29,1],[30,4],[30,3],[27,3],[27,1],[33,1],[20,1],[20,1],[20,1],[20,1],[20,1],[31,2],[31,1]],performAction:function(b,c,d,e,f,g,h){var i=g.length-1;switch(f){case 1:return new e.DocumentNode(g[i-1]);case 2:this.$=g[i];break;case 3:g[i-1].push(g[i]),this.$=g[i-1];break;case 4:this.$=[g[i]];break;case 5:this.$=new e.BlockNode(g[i-2],g[i-1],g[i]);break;case 6:this.$=g[i-1];break;case 7:this.$=new e.ContentNode(g[i]);break;case 8:this.$=new e.ExpressionNode(g[i-2],new e.FilterCollection(g[i]));break;case 9:this.$=new e.ExpressionNode(g[i],new e.FilterCollection([]));break;case 10:this.$=new e.PathNode(g[i],!1);break;case 11:this.$=new e.PathNode(g[i],!0);break;case 12:this.$=new e.ThisNode;break;case 13:this.$=g[i];break;case 14:this.$=new e.JoinedNodeCollection(g[i-2]);break;case 15:this.$=g[i];break;case 16:g[i-1].push(g[i]),this.$=g[i-1];break;case 17:this.$=[g[i]];break;case 18:this.$=new e.FilterNode(g[i-3],new e.NodeCollection(g[i-1]));break;case 19:this.$=new e.FilterNode(g[i],new e.NodeCollection([]));break;case 20:g[i-2].push(g[i]),this.$=g[i-2];break;case 21:this.$=[g[i]];break;case 22:this.$=g[i];break;case 23:this.$=g[i];break;case 24:this.$=new e.MethodNode(g[i-3],new e.NodeCollection(g[i-1]));break;case 25:this.$=new e.MethodNode(g[i-2],new e.NodeCollection([]));break;case 26:g[i-2].push(g[i]),this.$=g[i-2];break;case 27:this.$=[g[i]];break;case 28:this.$=g[i];break;case 29:this.$=new e.PrimitiveNode(g[i]);break;case 30:this.$=new e.PrimitiveNode(g[i]);break;case 31:this.$=new e.PrimitiveNode(!1);break;case 32:this.$=new e.PrimitiveNode(!0);break;case 33:this.$=new e.PrimitiveNode(parseFloat(g[i]));break;case 34:this.$=new e.MemberNode(g[i],!0);break;case 35:this.$=new e.MemberNode(g[i],!1)}},table:[{3:1,4:2,6:3,7:4,8:[1,5],13:[1,6]},{1:[3]},{5:[1,7]},{5:[2,2],7:8,8:[1,5],13:[1,6],22:[2,2]},{5:[2,4],8:[2,4],13:[2,4],22:[2,4]},{9:9,10:10,14:12,17:[1,13],18:14,19:[1,15],20:16,23:[1,11],24:[1,25],29:17,30:23,31:24,34:[1,18],35:[1,19],36:[1,20],37:[1,21],38:[1,22],39:[1,26]},{5:[2,7],8:[2,7],13:[2,7],22:[2,7]},{1:[2,1]},{5:[2,3],8:[2,3],13:[2,3],22:[2,3]},{10:27,14:12,17:[1,13],18:14,19:[1,15],20:16,24:[1,25],29:17,30:23,31:24,34:[1,18],35:[1,19],36:[1,20],37:[1,21],38:[1,22],39:[1,26]},{12:[1,28]},{24:[1,29]},{12:[2,9],15:[1,30],21:[2,9]},{18:31,24:[1,25],29:17,30:23,31:24,39:[1,26]},{12:[2,11],15:[2,11],19:[1,32],21:[2,11],28:[2,11],32:[2,11]},{12:[2,12],15:[2,12],21:[2,12],28:[2,12],32:[2,12]},{12:[2,13],15:[2,13],21:[2,13],28:[2,13],32:[2,13]},{12:[2,21],15:[2,21],19:[2,21],21:[2,21],28:[2,21],32:[2,21]},{12:[2,29],15:[2,29],21:[2,29],28:[2,29],32:[2,29]},{12:[2,30],15:[2,30],21:[2,30],28:[2,30],32:[2,30]},{12:[2,31],15:[2,31],21:[2,31],28:[2,31],32:[2,31]},{12:[2,32],15:[2,32],21:[2,32],28:[2,32],32:[2,32]},{12:[2,33],15:[2,33],21:[2,33],28:[2,33],32:[2,33]},{12:[2,22],15:[2,22],19:[2,22],21:[2,22],28:[2,22],32:[2,22]},{12:[2,23],15:[2,23],19:[2,23],21:[2,23],28:[2,23],32:[2,23]},{12:[2,35],15:[2,35],19:[2,35],21:[2,35],26:[1,33],28:[2,35],32:[2,35]},{24:[1,34]},{11:35,21:[1,36]},{5:[2,6],8:[2,6],13:[2,6],22:[2,6]},{17:[2,15],19:[2,15],24:[2,15],34:[2,15],35:[2,15],36:[2,15],37:[2,15],38:[2,15],39:[2,15]},{16:37,23:[1,39],25:38},{12:[2,10],15:[2,10],19:[1,32],21:[2,10],28:[2,10],32:[2,10]},{24:[1,25],29:40,30:23,31:24,39:[1,26]},{14:44,17:[1,13],18:14,19:[1,15],20:16,24:[1,25],27:41,28:[1,42],29:17,30:23,31:24,33:43,34:[1,18],35:[1,19],36:[1,20],37:[1,21],38:[1,22],39:[1,26]},{12:[2,34],15:[2,34],19:[2,34],21:[2,34],28:[2,34],32:[2,34]},{5:[2,5],8:[2,5],13:[2,5],22:[2,5]},{4:45,6:3,7:4,8:[1,5],13:[1,6]},{12:[2,8],21:[2,8],23:[1,39],25:46},{12:[2,17],21:[2,17],23:[2,17]},{24:[1,47]},{12:[2,20],15:[2,20],19:[2,20],21:[2,20],28:[2,20],32:[2,20]},{28:[1,48],32:[1,49]},{12:[2,25],15:[2,25],19:[2,25],21:[2,25],28:[2,25],32:[2,25]},{28:[2,27],32:[2,27]},{28:[2,28],32:[2,28]},{22:[1,50]},{12:[2,16],21:[2,16],23:[2,16]},{12:[2,19],21:[2,19],23:[2,19],26:[1,51]},{12:[2,24],15:[2,24],19:[2,24],21:[2,24],28:[2,24],32:[2,24]},{14:44,17:[1,13],18:14,19:[1,15],20:16,24:[1,25],29:17,30:23,31:24,33:52,34:[1,18],35:[1,19],36:[1,20],37:[1,21],38:[1,22],39:[1,26]},{12:[1,53]},{14:44,17:[1,13],18:14,19:[1,15],20:16,24:[1,25],27:54,29:17,30:23,31:24,33:43,34:[1,18],35:[1,19],36:[1,20],37:[1,21],38:[1,22],39:[1,26]},{28:[2,26],32:[2,26]},{5:[2,14],8:[2,14],13:[2,14],22:[2,14]},{28:[1,55],32:[1,49]},{12:[2,18],21:[2,18],23:[2,18]}],defaultActions:{7:[2,1]},parseError:function(b,c){throw new Error(b)},parse:function(b){function o(a){d.length=d.length-2*a,e.length=e.length-a,f.length=f.length-a}function p(){var a;return a=c.lexer.lex()||1,typeof a!="number"&&(a=c.symbols_[a]||a),a}var c=this,d=[0],e=[null],f=[],g=this.table,h="",i=0,j=0,k=0,l=2,m=1;this.lexer.setInput(b),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var n=this.lexer.yylloc;f.push(n),typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var q,r,s,t,u,v,w={},x,y,z,A;for(;;){s=d[d.length-1],this.defaultActions[s]?t=this.defaultActions[s]:(q==null&&(q=p()),t=g[s]&&g[s][q]);if(typeof t=="undefined"||!t.length||!t[0])if(!k){A=[];for(x in g[s])this.terminals_[x]&&x>2&&A.push("'"+this.terminals_[x]+"'");var B="";this.lexer.showPosition?B="Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+A.join(", ")+", got '"+this.terminals_[q]+"'":B="Parse error on line "+(i+1)+": Unexpected "+(q==1?"end of input":"'"+(this.terminals_[q]||q)+"'"),this.parseError(B,{text:this.lexer.match,token:this.terminals_[q]||q,line:this.lexer.yylineno,loc:n,expected:A})}if(t[0]instanceof Array&&t.length>1)throw new Error("Parse Error: multiple actions possible at state: "+s+", token: "+q);switch(t[0]){case 1:d.push(q),e.push(this.lexer.yytext),f.push(this.lexer.yylloc),d.push(t[1]),q=null,r?(q=r,r=null):(j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,n=this.lexer.yylloc,k>0&&k--);break;case 2:y=this.productions_[t[1]][1],w.$=e[e.length-y],w._$={first_line:f[f.length-(y||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(y||1)].first_column,last_column:f[f.length-1].last_column},v=this.performAction.call(w,h,j,i,this.yy,t[1],e,f);if(typeof v!="undefined")return v;y&&(d=d.slice(0,-1*y*2),e=e.slice(0,-1*y),f=f.slice(0,-1*y)),d.push(this.productions_[t[1]][0]),e.push(w.$),f.push(w._$),z=g[d[d.length-2]][d[d.length-1]],d.push(z);break;case 3:return!0}}return!0}},b=function(){var a={EOF:1,parseError:function(b,c){if(!this.yy.parseError)throw new Error(b);this.yy.parseError(b,c)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.match+=a,this.matched+=a;var b=a.match(/\n/);return b&&this.yylineno++,this._input=this._input.slice(1),a},unput:function(a){return this._input=a+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=(new Array(a.length+1)).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e,f;this._more||(this.yytext="",this.match="");var g=this._currentRules();for(var h=0;h<g.length;h++){c=this._input.match(this.rules[g[h]]);if(c&&(!b||c[0].length>b[0].length)){b=c,d=h;if(!this.options.flex)break}}if(b){f=b[0].match(/\n.*/g),f&&(this.yylineno+=f.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:f?f[f.length-1].length-1:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,g[d],this.conditionStack[this.conditionStack.length-1]);if(a)return a;return}if(this._input==="")return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var b=this.next();return typeof b!="undefined"?b:this.lex()},begin:function(b){this.conditionStack.push(b)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(b){this.begin(b)}};return a.options={},a.performAction=function(b,c,d,e){var f=e;switch(d){case 0:this.begin("mu");if(c.yytext)return 13;break;case 1:return 13;case 2:return this.begin("INITIAL"),21;case 3:return 22;case 4:return 8;case 5:return this.begin("INITIAL"),12;case 6:return 39;case 7:return 17;case 8:return 23;case 9:return 15;case 10:return 19;case 11:return 32;case 12:break;case 13:return c.yytext=c.yytext.substr(1,c.yyleng-2),34;case 14:return c.yytext=c.yytext.substr(1,c.yyleng-2),35;case 15:return 26;case 16:return 28;case 17:return 37;case 18:return 36;case 19:return 38;case 20:return 24;case 21:return 5}},a.rules=[/^[^\x00]*?(?=(\{\{))/,/^[^\x00]+/,/^do\s*\}\}/,/^\{\{\s*end\b/,/^\{\{/,/^\}\}/,/^=/,/^@/,/^:/,/^\|/,/^\./,/^,/,/^\s+/,/^'[^\']*?'/,/^"[^\"]*?"/,/^\(/,/^\)/,/^true\b/,/^false\b/,/^-?\d+(\.\d+)?/,/^[a-zA-Z0-9\_\$]+/,/^$/],a.conditions={mu:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],inclusive:!1},INITIAL:{rules:[0,1,21],inclusive:!0}},a}();return a.lexer=b,a}();typeof require!="undefined"&&typeof exports!="undefined"&&(exports.parser=g,exports.parse=function(){return g.parse.apply(g,arguments)},exports.main=function(b){if(!b[1])throw new Error("Usage: "+b[0]+" FILE");if(typeof process!="undefined")var c=require("fs").readFileSync(require("path").join(process.cwd(),b[1]),"utf8");else var d=require("file").path(require("file").cwd()),c=d.join(b[1]).read({charset:"utf-8"});return exports.parser.parse(c)},typeof module!="undefined"&&require.main===module&&exports.main(typeof process!="undefined"?process.argv.slice(1):require("system").args)),b={trim:function(a){return a.replace(/^\s+|\s+$/g,"")},reduce:function(a,b,c){var d,e,f,g;e=b;for(f=0,g=a.length;f<g;f++)d=a[f],e=c(e,d);return e},toString:function(a){return Object.prototype.toString.call(a)},isArray:function(a){return this.toString(a)==="[object Array]"},extend:function(a,b){var c,d,e;e=[];for(c in b)d=b[c],e.push(a[c]=d);return e},escapees:/[&'"<>]/g,escapes:{"&":"&amp;","'":"&#x27;",'"':"&quot;","<":"&lt;",">":"&gt;"},escape:function(a){var b=this;return a.replace(this.escapees,function(a){return b.escapes[a]||a})}},c.Utils=b,a={},a.NodeCollection=function(){function a(a){this.nodes=a}return a.prototype.compile=function(a,b){var c,d,e,f,g;f=this.nodes,g=[];for(d=0,e=f.length;d<e;d++)c=f[d],g.push(c.compile(a,b));return g},a}(),a.JoinedNodeCollection=function(a){function b(a){this.nodes=a}return e(b,a),b.prototype.compile=function(a,d){return c.Utils.trim(b.__super__.compile.call(this,a,d).join(""))},b}(a.NodeCollection),a.DocumentNode=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.compile=function(a){return b.__super__.compile.call(this,a,a)},b}(a.JoinedNodeCollection),a.ContentNode=function(){function a(a){this.content=a}return a.prototype.compile=function(a,b){return this.content},a}(),a.MemberNode=function(){function a(a,b){this.path=a,this.safe=b!=null?b:!1}return a.prototype.compile=function(a,b,d){return this.safe||typeof a[this.path]!="string"?a[this.path]:c.Utils.escape(a[this.path])},a}(),a.MethodNode=function(){function a(a,b){this.path=a,this.arguments=b}return a.prototype.compile=function(a,b,c){if(a[this.path]==null)throw"Cannot find any method named '"+this.path+"' in "+a+".";return a[this.path].apply(a,this.arguments.compile(b,c))},a}(),a.ThisNode=function(){function a(){}return a.prototype.compile=function(a,b){return a},a}(),a.PathNode=function(){function a(a,b){this.paths=a,this.local=b}return a.prototype.compile=function(a,b){var d,e;return d=this.paths.concat(),e=this.local?a:b,c.Utils.reduce(d,e,function(c,d){return d.compile(c,a,b)})},a}(),a.PrimitiveNode=function(){function a(a){this.value=a}return a.prototype.compile=function(a,b){return this.value},a}(),a.ExpressionNode=function(){function a(a,b){this.paths=a,this.filters=b}return a.prototype.compile=function(a,b){return this.filters.apply(this.paths.compile(a,b),a,b)},a}(),a.BlockNode=function(){function a(a,b,d){this.name=a,this.expression=b,this.block=d;if(c.Helpers[this.name]==null)throw"Cannot find any helper named '"+this.name+"'."}return a.prototype.compile=function(a,b){return c.Helpers[this.name](this.expression,a,b,this.block)},a}(),a.FilterNode=function(){function a(a,b){this.name=a,this.arguments=b;if(c.Filters[this.name]==null)throw"Cannot find any filter named '"+this.name+"'."}return a.prototype.apply=function(a,b,d){var e;return(e=c.Filters)[this.name].apply(e,[a].concat(f.call(this.arguments.compile(b,d))))},a}(),a.FilterCollection=function(){function a(a){this.filters=a}return a.prototype.apply=function(a,b,d){return c.Utils.reduce(this.filters,a,function(a,c){return c.apply(a,b,d)})},a}(),c.AST=a,c.Helpers={},c.addHelper=function(a,b){if(this.Helpers[a]!=null)throw"Cannot override existing helper named '"+a+"'.";return this.Helpers[a]=b},c.addHelper("if",function(a,b,c,d){return a.compile(b,c)?d.compile(b,c):""}),c.addHelper("unless",function(a,b,c,d){return a.compile(b,c)?"":d.compile(b,c)}),c.addHelper("each",function(a,b,c,d){var e,f,g,h;return e=a.compile(b,c),h=function(){var a,h;h=[];for(f=0,a=e.length;f<a;f++)g=e[f],g.$index=f,g.$parent=b,g.$length=e.length,h.push(d.compile(g,c));return h}(),h.join("")}),c.addHelper("with",function(a,b,c,d){var e;return e=a.compile(b,c),e.$parent=b,d.compile(e,c)}),c.Filters={},c.addFilter=function(a,b){if(this.Filters[a]!=null)throw"Cannot override existing filter named '"+a+"'.";return this.Filters[a]=b},c.addFilter("equals",function(a,b){return a===b}),c.addFilter("if",function(a,b){return b?a:""}),c.addFilter("unless",function(a,b){return b?"":a}),c.addFilter("or",function(a,b){return a||b}),c.addFilter("log",function(){if(typeof console!="undefined"&&console!==null&&console.log!=null)return console.log.apply(console,["[Walrus]"].concat(f.call(arguments)))}),c.Parser={parser:g,parse:function(){return g.parse.apply(g,arguments)}},c.Parser.parser.yy=c.AST,typeof require!="undefined"&&require!==null&&typeof exports!="undefined"&&exports!==null?module.exports=c:window.Walrus=c})).call(this)