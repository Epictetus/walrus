/**
 * Walrus.js 0.4.3
 * (c) 2012 Jeremy Ruppel
 * Walrus.js is freely distributable under the terms of the MIT license.
 * https://raw.github.com/jeremyruppel/walrus/master/LICENSE
 */
((function(){var a,b,c,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a},f=Array.prototype.slice;c={VERSION:"0.4.3"};var g=function(){var a={trace:function(){},yy:{},symbols_:{error:2,document:3,text:4,EOF:5,statements:6,statement:7,OPEN:8,helper:9,mustache:10,OPEN_BLOCK:11,CLOSE_BLOCK:12,CLOSE:13,CONTENT:14,expression:15,PIPE:16,filters:17,ATTR:18,paths:19,DOT:20,primitive:21,HELP:22,MEMBER:23,filter:24,OPEN_PAREN:25,arguments:26,CLOSE_PAREN:27,path:28,method:29,member:30,COMMA:31,argument:32,SINGLE_QUOTE_STRING_LITERAL:33,DOUBLE_QUOTE_STRING_LITERAL:34,BOOLEAN_FALSE:35,BOOLEAN_TRUE:36,NUMBER:37,SAFE:38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:"OPEN",11:"OPEN_BLOCK",12:"CLOSE_BLOCK",13:"CLOSE",14:"CONTENT",16:"PIPE",18:"ATTR",20:"DOT",22:"HELP",23:"MEMBER",25:"OPEN_PAREN",27:"CLOSE_PAREN",31:"COMMA",33:"SINGLE_QUOTE_STRING_LITERAL",34:"DOUBLE_QUOTE_STRING_LITERAL",35:"BOOLEAN_FALSE",36:"BOOLEAN_TRUE",37:"NUMBER",38:"SAFE"},productions_:[0,[3,2],[4,1],[6,2],[6,1],[7,7],[7,3],[7,1],[10,3],[10,1],[15,2],[15,1],[15,1],[15,1],[9,2],[17,2],[17,1],[24,5],[24,2],[19,3],[19,1],[28,1],[28,1],[29,4],[29,3],[26,3],[26,1],[32,1],[21,1],[21,1],[21,1],[21,1],[21,1],[30,2],[30,1]],performAction:function(b,c,d,e,f,g,h){var i=g.length-1;switch(f){case 1:return new e.DocumentNode(g[i-1]);case 2:this.$=g[i];break;case 3:g[i-1].push(g[i]),this.$=g[i-1];break;case 4:this.$=[g[i]];break;case 5:this.$=new e.BlockNode(g[i-5],g[i-4],new e.JoinedNodeCollection(g[i-2]));break;case 6:this.$=g[i-1];break;case 7:this.$=new e.ContentNode(g[i]);break;case 8:this.$=new e.ExpressionNode(g[i-2],new e.FilterCollection(g[i]));break;case 9:this.$=new e.ExpressionNode(g[i],new e.FilterCollection([]));break;case 10:this.$=new e.PathNode(g[i],!1);break;case 11:this.$=new e.PathNode(g[i],!0);break;case 12:this.$=new e.ThisNode;break;case 13:this.$=g[i];break;case 14:this.$=g[i];break;case 15:g[i-1].push(g[i]),this.$=g[i-1];break;case 16:this.$=[g[i]];break;case 17:this.$=new e.FilterNode(g[i-3],new e.NodeCollection(g[i-1]));break;case 18:this.$=new e.FilterNode(g[i],new e.NodeCollection([]));break;case 19:g[i-2].push(g[i]),this.$=g[i-2];break;case 20:this.$=[g[i]];break;case 21:this.$=g[i];break;case 22:this.$=g[i];break;case 23:this.$=new e.MethodNode(g[i-3],new e.NodeCollection(g[i-1]));break;case 24:this.$=new e.MethodNode(g[i-2],new e.NodeCollection([]));break;case 25:g[i-2].push(g[i]),this.$=g[i-2];break;case 26:this.$=[g[i]];break;case 27:this.$=g[i];break;case 28:this.$=new e.PrimitiveNode(g[i]);break;case 29:this.$=new e.PrimitiveNode(g[i]);break;case 30:this.$=new e.PrimitiveNode(!1);break;case 31:this.$=new e.PrimitiveNode(!0);break;case 32:this.$=new e.PrimitiveNode(parseFloat(g[i]));break;case 33:this.$=new e.MemberNode(g[i],!0);break;case 34:this.$=new e.MemberNode(g[i],!1)}},table:[{3:1,4:2,6:3,7:4,8:[1,5],14:[1,6]},{1:[3]},{5:[1,7]},{5:[2,2],7:8,8:[1,5],12:[2,2],14:[1,6]},{5:[2,4],8:[2,4],12:[2,4],14:[2,4]},{9:9,10:10,15:12,18:[1,13],19:14,20:[1,15],21:16,22:[1,11],23:[1,25],28:17,29:23,30:24,33:[1,18],34:[1,19],35:[1,20],36:[1,21],37:[1,22],38:[1,26]},{5:[2,7],8:[2,7],12:[2,7],14:[2,7]},{1:[2,1]},{5:[2,3],8:[2,3],12:[2,3],14:[2,3]},{10:27,15:12,18:[1,13],19:14,20:[1,15],21:16,23:[1,25],28:17,29:23,30:24,33:[1,18],34:[1,19],35:[1,20],36:[1,21],37:[1,22],38:[1,26]},{13:[1,28]},{23:[1,29]},{11:[2,9],13:[2,9],16:[1,30]},{19:31,23:[1,25],28:17,29:23,30:24,38:[1,26]},{11:[2,11],13:[2,11],16:[2,11],20:[1,32],27:[2,11],31:[2,11]},{11:[2,12],13:[2,12],16:[2,12],27:[2,12],31:[2,12]},{11:[2,13],13:[2,13],16:[2,13],27:[2,13],31:[2,13]},{11:[2,20],13:[2,20],16:[2,20],20:[2,20],27:[2,20],31:[2,20]},{11:[2,28],13:[2,28],16:[2,28],27:[2,28],31:[2,28]},{11:[2,29],13:[2,29],16:[2,29],27:[2,29],31:[2,29]},{11:[2,30],13:[2,30],16:[2,30],27:[2,30],31:[2,30]},{11:[2,31],13:[2,31],16:[2,31],27:[2,31],31:[2,31]},{11:[2,32],13:[2,32],16:[2,32],27:[2,32],31:[2,32]},{11:[2,21],13:[2,21],16:[2,21],20:[2,21],27:[2,21],31:[2,21]},{11:[2,22],13:[2,22],16:[2,22],20:[2,22],27:[2,22],31:[2,22]},{11:[2,34],13:[2,34],16:[2,34],20:[2,34],25:[1,33],27:[2,34],31:[2,34]},{23:[1,34]},{11:[1,35]},{5:[2,6],8:[2,6],12:[2,6],14:[2,6]},{18:[2,14],20:[2,14],23:[2,14],33:[2,14],34:[2,14],35:[2,14],36:[2,14],37:[2,14],38:[2,14]},{17:36,22:[1,38],24:37},{11:[2,10],13:[2,10],16:[2,10],20:[1,32],27:[2,10],31:[2,10]},{23:[1,25],28:39,29:23,30:24,38:[1,26]},{15:43,18:[1,13],19:14,20:[1,15],21:16,23:[1,25],26:40,27:[1,41],28:17,29:23,30:24,32:42,33:[1,18],34:[1,19],35:[1,20],36:[1,21],37:[1,22],38:[1,26]},{11:[2,33],13:[2,33],16:[2,33],20:[2,33],27:[2,33],31:[2,33]},{4:44,6:3,7:4,8:[1,5],14:[1,6]},{11:[2,8],13:[2,8],22:[1,38],24:45},{11:[2,16],13:[2,16],22:[2,16]},{23:[1,46]},{11:[2,19],13:[2,19],16:[2,19],20:[2,19],27:[2,19],31:[2,19]},{27:[1,47],31:[1,48]},{11:[2,24],13:[2,24],16:[2,24],20:[2,24],27:[2,24],31:[2,24]},{27:[2,26],31:[2,26]},{27:[2,27],31:[2,27]},{12:[1,49]},{11:[2,15],13:[2,15],22:[2,15]},{11:[2,18],13:[2,18],22:[2,18],25:[1,50]},{11:[2,23],13:[2,23],16:[2,23],20:[2,23],27:[2,23],31:[2,23]},{15:43,18:[1,13],19:14,20:[1,15],21:16,23:[1,25],28:17,29:23,30:24,32:51,33:[1,18],34:[1,19],35:[1,20],36:[1,21],37:[1,22],38:[1,26]},{13:[1,52]},{15:43,18:[1,13],19:14,20:[1,15],21:16,23:[1,25],26:53,28:17,29:23,30:24,32:42,33:[1,18],34:[1,19],35:[1,20],36:[1,21],37:[1,22],38:[1,26]},{27:[2,25],31:[2,25]},{5:[2,5],8:[2,5],12:[2,5],14:[2,5]},{27:[1,54],31:[1,48]},{11:[2,17],13:[2,17],22:[2,17]}],defaultActions:{7:[2,1]},parseError:function(b,c){throw new Error(b)},parse:function(b){function o(a){d.length=d.length-2*a,e.length=e.length-a,f.length=f.length-a}function p(){var a;return a=c.lexer.lex()||1,typeof a!="number"&&(a=c.symbols_[a]||a),a}var c=this,d=[0],e=[null],f=[],g=this.table,h="",i=0,j=0,k=0,l=2,m=1;this.lexer.setInput(b),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var n=this.lexer.yylloc;f.push(n),typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var q,r,s,t,u,v,w={},x,y,z,A;for(;;){s=d[d.length-1],this.defaultActions[s]?t=this.defaultActions[s]:(q==null&&(q=p()),t=g[s]&&g[s][q]);if(typeof t=="undefined"||!t.length||!t[0])if(!k){A=[];for(x in g[s])this.terminals_[x]&&x>2&&A.push("'"+this.terminals_[x]+"'");var B="";this.lexer.showPosition?B="Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+A.join(", ")+", got '"+this.terminals_[q]+"'":B="Parse error on line "+(i+1)+": Unexpected "+(q==1?"end of input":"'"+(this.terminals_[q]||q)+"'"),this.parseError(B,{text:this.lexer.match,token:this.terminals_[q]||q,line:this.lexer.yylineno,loc:n,expected:A})}if(t[0]instanceof Array&&t.length>1)throw new Error("Parse Error: multiple actions possible at state: "+s+", token: "+q);switch(t[0]){case 1:d.push(q),e.push(this.lexer.yytext),f.push(this.lexer.yylloc),d.push(t[1]),q=null,r?(q=r,r=null):(j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,n=this.lexer.yylloc,k>0&&k--);break;case 2:y=this.productions_[t[1]][1],w.$=e[e.length-y],w._$={first_line:f[f.length-(y||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(y||1)].first_column,last_column:f[f.length-1].last_column},v=this.performAction.call(w,h,j,i,this.yy,t[1],e,f);if(typeof v!="undefined")return v;y&&(d=d.slice(0,-1*y*2),e=e.slice(0,-1*y),f=f.slice(0,-1*y)),d.push(this.productions_[t[1]][0]),e.push(w.$),f.push(w._$),z=g[d[d.length-2]][d[d.length-1]],d.push(z);break;case 3:return!0}}return!0}},b=function(){var a={EOF:1,parseError:function(b,c){if(!this.yy.parseError)throw new Error(b);this.yy.parseError(b,c)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.match+=a,this.matched+=a;var b=a.match(/\n/);return b&&this.yylineno++,this._input=this._input.slice(1),a},unput:function(a){return this._input=a+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=(new Array(a.length+1)).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e,f;this._more||(this.yytext="",this.match="");var g=this._currentRules();for(var h=0;h<g.length;h++){c=this._input.match(this.rules[g[h]]);if(c&&(!b||c[0].length>b[0].length)){b=c,d=h;if(!this.options.flex)break}}if(b){f=b[0].match(/\n.*/g),f&&(this.yylineno+=f.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:f?f[f.length-1].length-1:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,g[d],this.conditionStack[this.conditionStack.length-1]);if(a)return a;return}if(this._input==="")return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var b=this.next();return typeof b!="undefined"?b:this.lex()},begin:function(b){this.conditionStack.push(b)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(b){this.begin(b)}};return a.options={},a.performAction=function(b,c,d,e){var f=e;switch(d){case 0:this.begin("mu");if(c.yytext)return 14;break;case 1:return 14;case 2:return this.begin("INITIAL"),11;case 3:return 12;case 4:return 8;case 5:return this.begin("INITIAL"),13;case 6:return 38;case 7:return 18;case 8:return 22;case 9:return 16;case 10:return 20;case 11:return 31;case 12:break;case 13:return c.yytext=c.yytext.substr(1,c.yyleng-2),33;case 14:return c.yytext=c.yytext.substr(1,c.yyleng-2),34;case 15:return 25;case 16:return 27;case 17:return 36;case 18:return 35;case 19:return 37;case 20:return 23;case 21:return 5}},a.rules=[/^[^\x00]*?(?=(\{\{))/,/^[^\x00]+/,/^do\s*\}\}/,/^\{\{\s*end\b/,/^\{\{/,/^\}\}/,/^=/,/^@/,/^:/,/^\|/,/^\./,/^,/,/^\s+/,/^'[^\']*?'/,/^"[^\"]*?"/,/^\(/,/^\)/,/^true\b/,/^false\b/,/^-?\d+(\.\d+)?/,/^[a-zA-Z0-9\_\$]+/,/^$/],a.conditions={mu:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],inclusive:!1},INITIAL:{rules:[0,1,21],inclusive:!0}},a}();return a.lexer=b,a}();typeof require!="undefined"&&typeof exports!="undefined"&&(exports.parser=g,exports.parse=function(){return g.parse.apply(g,arguments)},exports.main=function(b){if(!b[1])throw new Error("Usage: "+b[0]+" FILE");if(typeof process!="undefined")var c=require("fs").readFileSync(require("path").join(process.cwd(),b[1]),"utf8");else var d=require("file").path(require("file").cwd()),c=d.join(b[1]).read({charset:"utf-8"});return exports.parser.parse(c)},typeof module!="undefined"&&require.main===module&&exports.main(typeof process!="undefined"?process.argv.slice(1):require("system").args)),b={trim:function(a){return a.replace(/^\s+|\s+$/g,"")},reduce:function(a,b,c){var d,e,f,g;e=b;for(f=0,g=a.length;f<g;f++)d=a[f],e=c(e,d);return e},toString:function(a){return Object.prototype.toString.call(a)},isArray:function(a){return this.toString(a)==="[object Array]"},extend:function(a,b){var c,d,e;e=[];for(c in b)d=b[c],e.push(a[c]=d);return e},escapees:/[&'"<>]/g,escapes:{"&":"&amp;","'":"&#x27;",'"':"&quot;","<":"&lt;",">":"&gt;"},escape:function(a){var b=this;return a.replace(this.escapees,function(a){return b.escapes[a]||a})}},c.Utils=b,a={},a.NodeCollection=function(){function a(a){this.nodes=a}return a.prototype.compile=function(a,b){var c,d,e,f,g;f=this.nodes,g=[];for(d=0,e=f.length;d<e;d++)c=f[d],g.push(c.compile(a,b));return g},a}(),a.JoinedNodeCollection=function(a){function b(a){this.nodes=a}return e(b,a),b.prototype.compile=function(a,d){return c.Utils.trim(b.__super__.compile.call(this,a,d).join(""))},b}(a.NodeCollection),a.DocumentNode=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.compile=function(a){return b.__super__.compile.call(this,a,a)+"\n"},b}(a.JoinedNodeCollection),a.ContentNode=function(){function a(a){this.content=a}return a.prototype.compile=function(a,b){return this.content},a}(),a.MemberNode=function(){function a(a,b){this.path=a,this.safe=b!=null?b:!1}return a.prototype.compile=function(a,b,d){return this.safe||typeof a[this.path]!="string"?a[this.path]:c.Utils.escape(a[this.path])},a}(),a.MethodNode=function(){function a(a,b){this.path=a,this.arguments=b}return a.prototype.compile=function(a,b,c){if(a[this.path]==null)throw"Cannot find any method named '"+this.path+"' in "+a+".";return a[this.path].apply(a,this.arguments.compile(b,c))},a}(),a.ThisNode=function(){function a(){}return a.prototype.compile=function(a,b){return a},a}(),a.PathNode=function(){function a(a,b){this.paths=a,this.local=b}return a.prototype.compile=function(a,b){var d,e;return d=this.paths.concat(),e=this.local?a:b,c.Utils.reduce(d,e,function(c,d){return d.compile(c,a,b)})},a}(),a.PrimitiveNode=function(){function a(a){this.value=a}return a.prototype.compile=function(a,b){return this.value},a}(),a.ExpressionNode=function(){function a(a,b){this.paths=a,this.filters=b}return a.prototype.compile=function(a,b){return this.filters.apply(this.paths.compile(a,b),a,b)},a}(),a.BlockNode=function(){function a(a,b,d){this.name=a,this.expression=b,this.block=d;if(c.Helpers[this.name]==null)throw"Cannot find any helper named '"+this.name+"'."}return a.prototype.compile=function(a,b){return c.Helpers[this.name](this.expression,a,b,this.block)},a}(),a.FilterNode=function(){function a(a,b){this.name=a,this.arguments=b;if(c.Filters[this.name]==null)throw"Cannot find any filter named '"+this.name+"'."}return a.prototype.apply=function(a,b,d){var e;return(e=c.Filters)[this.name].apply(e,[a].concat(f.call(this.arguments.compile(b,d))))},a}(),a.FilterCollection=function(){function a(a){this.filters=a}return a.prototype.apply=function(a,b,d){return c.Utils.reduce(this.filters,a,function(a,c){return c.apply(a,b,d)})},a}(),c.AST=a,c.Helpers={},c.addHelper=function(a,b){if(this.Helpers[a]!=null)throw"Cannot override existing helper named '"+a+"'.";return this.Helpers[a]=b},c.addHelper("if",function(a,b,c,d){return a.compile(b,c)?d.compile(b,c):""}),c.addHelper("unless",function(a,b,c,d){return a.compile(b,c)?"":d.compile(b,c)}),c.addHelper("each",function(a,b,c,d){var e,f,g,h;return e=a.compile(b,c),h=function(){var a,h;h=[];for(f=0,a=e.length;f<a;f++)g=e[f],g.$index=f,g.$parent=b,g.$length=e.length,h.push(d.compile(g,c));return h}(),h.join("")}),c.addHelper("with",function(a,b,c,d){var e;return e=a.compile(b,c),e.$parent=b,d.compile(e,c)}),c.Filters={},c.addFilter=function(a,b){if(this.Filters[a]!=null)throw"Cannot override existing filter named '"+a+"'.";return this.Filters[a]=b},c.addFilter("equals",function(a,b){return a===b}),c.addFilter("if",function(a,b){return b?a:""}),c.addFilter("or",function(a,b){return a||b}),c.addFilter("log",function(){if(typeof console!="undefined"&&console!==null&&console.log!=null)return console.log.apply(console,["[Walrus]"].concat(f.call(arguments)))}),c.Parser={parser:g,parse:function(){return g.parse.apply(g,arguments)}},c.Parser.parser.yy=c.AST,typeof require!="undefined"&&require!==null&&typeof exports!="undefined"&&exports!==null?module.exports=c:window.Walrus=c})).call(this)